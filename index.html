<!DOCTYPE html>
<html>
  <head>
      <meta charset="UTF-8" />
      <title>Supermarkets</title>

      <!-- Remember to edit the CSS so that your result looks similar
      to expectedresult.png -->
      <link rel="stylesheet" href="_css/hw1.css">

      <script src="_js/jquery-1.11.0.min.js"></script>
      <script src="_js/highcharts.js"></script>
  </head>

  <body>

    <div id="wrapper">
      <h3>Markets Shiz... by Peter Rowland & Steve Trush</h3>

      <!--
      ADD two div containers, one for each chart.
      Make sure you adjust the CSS so that the end result looks
      similar to expectedresult.png. The two charts should be side-by-side.
      If you are having issues make sure your browser is not zoomed in past 100%.
      -->
      <div id="chart-rev-ca"> </div>
      <div id="chart-rev-tx"> </div>
      <div id="chart-rev-or"> </div>      

    </div>

    <script>

    // Here we are declaring a function using Highcharts.setOptions
    // This configures global options that will apply for both charts.
    // These options work like a style theme.
    // http://www.highcharts.com/docs/getting-started/how-to-set-options#2
    $(function () {
      Highcharts.setOptions({
        chart: {
          style: {
            fontFamily: "Helvetica,Arial,sans-serif"
          }
        },
        legend: {
          borderRadius: 0,
          itemStyle: {
            color: "#000000",
            fontFamily: "Helvetica,Arial,sans-serif",
            fontSize: "14px",
            fontWeight: "bold"
          }
        },
        title: {
          style: {
            color: "#000000",
            fontFamily: "Helvetica,Arial,sans-serif",
            fontSize: "20px",
            fontWeight: "bold"
          }
        },
        tooltip: {
          // ADD CODE HERE to set up the tooltip options.
          // Hints: borderRadius, borderWidth, shadow
          borderRadius: 5,
          borderWidth: 1,
          shadow: true,

          style: {
            color: "#333333",
            fontFamily: "Arial, sans-serif",
            fontSize: "20px",
            padding: "10px"
          }
        },
        xAxis: {
          labels: {
            style: {
              color: "#333333",
              fontFamily: "Helvetica,Arial,sans-serif",
              fontSize: "12px"
            }
          },
          //max: 220,
          //min: 0,
        },
        yAxis: {
          labels: {
            style: {
              color: "#333333",
              fontFamily: "Helvetica,Arial,sans-serif",
              fontSize: "12px"
            }
          },
          type: 'logarithmic',
          tickInterval: .1,
          max: 8000,
          min: 100,
          plotLines: [{
            value: 0,
            width: 1,
            color: "#808080"
          }],
        }
      })
    });

    // Set up an options object that will hold the charts' shared xAxis categories
    // ADD CODE HERE to hold the xAxis categories
    var options = {
      xAxis: {
        categories: ['2011', '2012', '2013', '2014', '2015']
      },
      yAxis: {
        title: {
            text: 'Annual Revenue (in million USD)',
            style: {
              color: "#333333",
              fontFamily: "Helvetica,Arial,sans-serif",
              fontSize: "18px"
            }
        },
        plotLines: [{
            value: 0,
            width: 3,
            color: '#808080'
        }]
      },
      tooltip: {
        valuePrefix: '$',
        valueSuffix: 'mil'
      },
      legend: {
        layout: 'vertical',
        align: 'right',
        verticalAlign: 'middle',
        borderWidth: 0
      },
    };
        
    var chartRevCa = {      
        title: {
          text: "Revenue in California"
        },
        chart: {
        // ADD CODE HERE to fill in the renderTo property with the div id for your second chart container
          renderTo: "chart-rev-ca",
        // ADD CODE HERE to fill in the type property to make a line chart
          type: "line"
        },
        series: []
    };
    var chartRevTx = {      
        title: {
          text: "Revenue in Texas"
        },      
        chart: {
        // ADD CODE HERE to fill in the renderTo property with the div id for your second chart container
          renderTo: "chart-rev-tx",
        // ADD CODE HERE to fill in the type property to make a line chart
          type: "line"
        },
        series: []
    };
    var chartRevOr = {      
        title: {
          text: "Revenue in Oregon"
        },      
        chart: {
        // ADD CODE HERE to fill in the renderTo property with the div id for your second chart container
          renderTo: "chart-rev-or",
        // ADD CODE HERE to fill in the type property to make a line chart
          type: "line"
      },
      series: []
    };
        

    // Here we are declaring a function to return color for each season.
    // This allows us to choose the colors that will be used in the charts.
    function colors(i) {
      switch(i) {
        case 0:
          return "#f05555"; // walmart
          break;
        case 1:
          return "#1bdb1b"; // safeway
          break;
        case 2:
          return "#4545ff"; // whole foods
          break;
        case 3:
          return "#d030d0"; // target
          break;
        case 4:
          return "#d6ea3b"; // safeway
          break;
        case 5:
          return "#333333"; // whole foods
          break;
        case 6:
          return "#ff8319"; // target
      };
    };

    $.get("_data/supermarkets.csv", function(data) {

    // We'll split the CSV by line ("\n")
      var lines = data.split('\n');
      // ADD CODE HERE to set up variables for the Chart One data:
        // Declare a variable "seasons" that is an empty array that will be populated by the season names.
      var storenames = ["Walmart","Safeway","Whole Foods","Target","Costco","Kmart","Trader Joes"];
      var stores = {"Walmart":0,"Safeway":1,"Whole Foods":2,"Target":3,"Costco":4,"Kmart":5,"Trader Joes":6};
      var states = {"California":0,"Texas":1,"Oregon":2};
        // Declare a variable "rainBySeason" that is an array containing 4 empty arrays, each of will be populated by rainfall sums per season (e.g. [17.41, 13.07, 6.99, ...] for winter).
      var revByStore = new Array(7);
      for (var i = 0; i < revByStore.length; i++){

          revByStore[i] = [[],[],[]];
      }

      $.each(lines, function(index,value) {
        var line = value;
        var lineNo = index;

        var items = line.split(",");
        // If it's the header...
        if (lineNo == 0) {

        // Otherwise, if you're working with content...
        } else {

          // Now we need to populate "options.xAxis.categories" array with the Years ("2000", "2001", "2002", etc.)
          // Each line of data is a year so we want to add the first value in the array to the xAxis categories.
          var store = stores[items[0]];
          var state = states[items[1]];
                    console.log(items[0]);
                    console.log(items[1]);
          revByStore[store][state].push(parseFloat(items[5]));
         }; // /else

       }); // /$.each()

        // We'll use a for loop to populate "chartOne.series"
        for(var i = 0; i < revByStore.length; i++) {
           var chartRevCaData = {
                name: storenames[i],
                data: revByStore[i][0],
                color: colors(i),
                index: revByStore.length - 1 - i,
                legendIndex: i
            };

        // ADD CODE HERE to push the chartOneData object to "chartOne.series":
            chartRevCa.series.push(chartRevCaData);
        };
        
        for(var i = 0; i < revByStore.length; i++) {
           var chartRevTxData = {
                name: storenames[i],
                data: revByStore[i][1],
                color: colors(i),
                index: revByStore.length - 1 - i,
                legendIndex: i
            };

        // ADD CODE HERE to push the chartOneData object to "chartOne.series":
            chartRevTx.series.push(chartRevTxData);
        };
        
        for(var i = 0; i < revByStore.length; i++) {
           var chartRevOrData = {
                name: storenames[[i]],
                data: revByStore[i][2],
                color: colors(i),
                index: revByStore.length - 1 - i,
                legendIndex: i
            };

        // ADD CODE HERE to push the chartOneData object to "chartOne.series":
            chartRevOr.series.push(chartRevOrData);
        };
        

      chartRevCa = jQuery.extend(true, {}, options, chartRevCa);
      var chart1 = new Highcharts.Chart(chartRevCa);
      
      chartRevTx = jQuery.extend(true, {}, options, chartRevTx);
      var chart2 = new Highcharts.Chart(chartRevTx);        

      chartRevOr = jQuery.extend(true, {}, options, chartRevOr);
      var chart3 = new Highcharts.Chart(chartRevOr);        

    });


    </script>

  </body>

</html>
